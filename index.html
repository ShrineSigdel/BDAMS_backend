<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Firebase Auth Tester</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 2em;
            line-height: 1.6;
        }

        .container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        input {
            width: 95%;
            padding: 8px;
            margin-bottom: 10px;
        }

        button {
            padding: 10px 15px;
            cursor: pointer;
        }

        #token_output {
            background-color: #f0f0f0;
            padding: 15px;
            border: 1px solid #ddd;
            word-wrap: break-word;
            margin-top: 20px;
        }

        #error {
            color: red;
        }
    </style>
</head>

<body>

    <div class="container">
        <h2>Firebase ID Token Grabber</h2>
        <p>Use this to sign up or log in a test user and get their ID token for API testing.</p>

        <hr>

        <h3>Email & Password</h3>
        <input type="email" id="email" placeholder="Email" />
        <input type="password" id="password" placeholder="Password" />
        <br />
        <button onclick="signUp()">Sign Up</button>
        <button onclick="logIn()">Log In</button>
        <button onclick="logOut()">Log Out</button>

        <p id="status">Status: Not logged in</p>
        <p id="error"></p>

        <div id="token_output">
            <strong>ID Token will appear here...</strong>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

    <script>
        // --- START: PASTE YOUR FIREBASE CONFIGURATION HERE ---
            const firebaseConfig = {
                apiKey: "AIzaSyAv0HtpEj_GjGz5u-Gb1USVFBmV7wxld4s",
                authDomain: "bdams-f241f.firebaseapp.com",
                projectId: "bdams-f241f",
                storageBucket: "bdams-f241f.firebasestorage.app",
                messagingSenderId: "745158169384",
                appId: "1:745158169384:web:04af9310c2afe206bc361d"
            };
        // --- END: PASTE YOUR FIREBASE CONFIGURATION HERE ---


        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const tokenOutput = document.getElementById('token_output');
        const statusEl = document.getElementById('status');
        const errorEl = document.getElementById('error');

        // Function to sign up a new user
        function signUp() {
            const email = emailInput.value;
            const password = passwordInput.value;
            auth.createUserWithEmailAndPassword(email, password)
                .then(userCredential => {
                    statusEl.innerText = `Signed up and logged in as: ${userCredential.user.email}`;
                    errorEl.innerText = '';
                })
                .catch(error => {
                    errorEl.innerText = `Error: ${error.message}`;
                });
        }

        // Function to log in an existing user
        function logIn() {
            const email = emailInput.value;
            const password = passwordInput.value;
            auth.signInWithEmailAndPassword(email, password)
                .then(userCredential => {
                    statusEl.innerText = `Logged in as: ${userCredential.user.email}`;
                    errorEl.innerText = '';
                })
                .catch(error => {
                    errorEl.innerText = `Error: ${error.message}`;
                });
        }

        function logOut() {
            auth.signOut();
        }

        // Listen for changes in authentication state (login/logout)
        auth.onAuthStateChanged(user => {
            if (user) {
                // User is signed in. Get the token!
                statusEl.innerText = `Status: Logged in as ${user.email}`;
                tokenOutput.innerText = 'Getting token...';
                user.getIdToken().then(token => {
                    // This is the token you need for Postman!
                    tokenOutput.innerText = token;
                    console.log("ID TOKEN:", token);
                });
            } else {
                // User is signed out.
                statusEl.innerText = 'Status: Not logged in';
                tokenOutput.innerText = 'ID Token will appear here...';
            }
        });

    </script>
</body>

</html>